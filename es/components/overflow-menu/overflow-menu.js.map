{"version":3,"file":"overflow-menu.js","names":["html","property","prefix","HostListener","FocusMixin","HostListenerMixin","find","OVERFLOW_MENU_SIZE","styles","CDSIconButton","carbonElement","customElement","CDSOverflowMenu","_decorate","_initialize","_HostListenerMixin","constructor","args","F","d","kind","key","value","_handleUserInitiatedToggle","open","index","updateComplete","_menuBody","menuBody","menuItem","querySelector","focus","decorators","event","preventDefault","type","Boolean","reflect","attribute","MEDIUM","triggerPosition","getBoundingClientRect","connectedCallback","hasAttribute","setAttribute","shadowRoot","attachShadow","mode","_get","_getPrototypeOf","prototype","call","updated","changedProperties","_this$shadowRoot","button","classList","add","has","childNodes","elem","FLOATING_MENU","_this$querySelector","tooltipContent","textContent","String","_this$shadowRoot2","tooltip","_this$shadowRoot3","size","forEach","item","startsWith","remove","toolbarAction","_this$shadowRoot4","render","_t","_","static"],"sources":["components/overflow-menu/overflow-menu.ts"],"sourcesContent":["/**\n * @license\n *\n * Copyright IBM Corp. 2019, 2023\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { html } from 'lit';\nimport { property } from 'lit/decorators.js';\nimport { prefix } from '../../globals/settings';\nimport HostListener from '../../globals/decorators/host-listener';\nimport FocusMixin from '../../globals/mixins/focus';\nimport HostListenerMixin from '../../globals/mixins/host-listener';\nimport { find } from '../../globals/internal/collection-helpers';\nimport CDSFloatingMenuTrigger from '../floating-menu/floating-menu-trigger';\nimport { OVERFLOW_MENU_SIZE } from './defs';\nimport CDSOverflowMenuBody from './overflow-menu-body';\nimport styles from './overflow-menu.scss';\nimport CDSIconButton from '../icon-button/icon-button';\nimport { carbonElement as customElement } from '../../globals/decorators/carbon-element';\n\nexport { OVERFLOW_MENU_SIZE };\n\n/**\n * Overflow menu.\n *\n * @element cds-overflow-menu\n * @slot icon - The icon for the trigger button.\n */\n@customElement(`${prefix}-overflow-menu`)\nclass CDSOverflowMenu\n  extends HostListenerMixin(FocusMixin(CDSIconButton))\n  implements CDSFloatingMenuTrigger\n{\n  /**\n   * The menu body.\n   */\n  private _menuBody: CDSOverflowMenuBody | null = null;\n\n  /**\n   * Handles user-initiated toggling of the menu.\n   */\n  private async _handleUserInitiatedToggle() {\n    this.open = !this.open;\n    const { index, open, updateComplete } = this;\n    if (open) {\n      await updateComplete;\n      const { _menuBody: menuBody } = this;\n      const menuItem = menuBody?.querySelector(\n        `${prefix}-overflow-menu-item:nth-of-type(${index})`\n      ) as HTMLElement;\n      menuItem?.focus();\n    }\n  }\n\n  /**\n   * Handles `click` event on the trigger button.\n   */\n  @HostListener('click')\n  // @ts-ignore: The decorator refers to this method but TS thinks this method is not referred to\n  private _handleClickTrigger = async () => {\n    this._handleUserInitiatedToggle();\n  };\n\n  /**\n   * Handles `keydown` event on the trigger button.\n   */\n  @HostListener('keydown')\n  // @ts-ignore: The decorator refers to this method but TS thinks this method is not referred to\n  private _handleKeydownTrigger = async (event) => {\n    if (event.key === ' ' || event.key === 'Enter') {\n      this._handleUserInitiatedToggle();\n      event.preventDefault();\n    }\n  };\n\n  /**\n   * `true` if this tooltip is in a data table row\n   */\n  @property({ type: Boolean, reflect: true, attribute: 'data-table' })\n  dataTable = false;\n\n  /**\n   * `true` if this overflow menu should be disabled.\n   */\n  @property({ type: Boolean, reflect: true })\n  disabled = false;\n\n  /**\n   * `true` if this overflow menu body should be flipped.\n   */\n  @property({ type: Boolean, reflect: true })\n  flipped = false;\n\n  /**\n   * `true` if the dropdown should be open.\n   */\n  @property({ type: Boolean, reflect: true })\n  open = false;\n\n  /**\n   * Index (starting at 1) of overflow menu item to focus on open.\n   */\n  @property()\n  index = 1;\n\n  /**\n   * Overflow menu size.\n   */\n  @property({ reflect: true })\n  size = OVERFLOW_MENU_SIZE.MEDIUM;\n\n  /**\n   * `true` if this menu is a toolbar action\n   */\n  @property({ type: Boolean, attribute: 'toolbar-action', reflect: true })\n  toolbarAction = false;\n\n  /**\n   * @returns The position of the trigger button in the viewport.\n   */\n  get triggerPosition() {\n    return this.getBoundingClientRect();\n  }\n\n  connectedCallback() {\n    if (!this.hasAttribute('aria-haspopup')) {\n      this.setAttribute('aria-haspopup', 'true');\n    }\n    if (!this.shadowRoot) {\n      this.attachShadow({ mode: 'open' });\n    }\n    super.connectedCallback();\n  }\n\n  updated(changedProperties) {\n    const button = this.shadowRoot\n      ?.querySelector(`${prefix}-tooltip`)\n      ?.querySelector('button');\n    button?.classList.add(\n      `${prefix}--btn--icon-only`,\n      `${prefix}--overflow-menu`\n    );\n\n    if (changedProperties.has('open')) {\n      const { open } = this;\n      if (open && !this._menuBody) {\n        this._menuBody = find(\n          this.childNodes,\n          (elem) =>\n            (elem.constructor as typeof CDSOverflowMenuBody).FLOATING_MENU\n        );\n      }\n      const { _menuBody: menuBody } = this;\n      if (menuBody) {\n        menuBody.open = open;\n\n        const tooltipContent = this.querySelector(\n          '[slot=tooltip-content]'\n        )?.textContent;\n        button?.setAttribute('aria-expanded', String(Boolean(open)));\n        button?.setAttribute('aria-label', String(tooltipContent));\n      }\n    }\n\n    if (changedProperties.has('dataTable')) {\n      const tooltip = this.shadowRoot?.querySelector(`${prefix}-tooltip`);\n      tooltip?.setAttribute('data-table', '');\n    }\n\n    if (changedProperties.has('size')) {\n      const { size } = this;\n      const { _menuBody: menuBody } = this;\n      if (menuBody) {\n        menuBody.size = size;\n      }\n\n      button?.classList.forEach((item) => {\n        if (item.startsWith(`${prefix}--overflow-menu--`)) {\n          button?.classList.remove(item);\n        }\n      });\n      button?.classList.add(`${prefix}--overflow-menu--${this.size}`);\n\n      const tooltip = this.shadowRoot?.querySelector(`${prefix}-tooltip`);\n      tooltip?.setAttribute('size', this.size);\n    }\n\n    if (changedProperties.has('toolbarAction') && this.toolbarAction) {\n      this.shadowRoot\n        ?.querySelector(`${prefix}-tooltip`)\n        ?.setAttribute('toolbar-action', '');\n    }\n\n    super.updated(changedProperties);\n  }\n\n  render() {\n    return html` ${super.render()} `;\n  }\n\n  static styles = styles; // `styles` here is a `CSSResult` generated by custom WebPack loader\n}\n\nexport default CDSOverflowMenu;\n"],"mappings":"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"}