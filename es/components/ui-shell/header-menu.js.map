{"version":3,"file":"header-menu.js","names":["ifDefined","LitElement","html","property","query","classMap","ChevronDownGlyph","prefix","FocusMixin","HostListenerMixin","HostListener","forEach","styles","carbonElement","customElement","CDSHeaderMenu","_decorate","_initialize","_HostListenerMixin","constructor","args","F","d","kind","decorators","key","value","_handleClick","_handleUserInitiatedToggle","_handleKeydownTrigger","force","expanded","_topMenuItem","focus","_handleBlur","relatedTarget","contains","type","Boolean","reflect","attribute","connectedCallback","hasAttribute","setAttribute","selectorItem","querySelectorAll","elem","isActive","_hasActiveChildren","_get","_getPrototypeOf","prototype","call","updated","changedProperties","has","tabIndex","render","triggerContent","menuLabel","handleClick","linkClasses","_t","_","String","part","class","static","_objectSpread","shadowRootOptions","delegatesFocus"],"sources":["components/ui-shell/header-menu.ts"],"sourcesContent":["/**\n * @license\n *\n * Copyright IBM Corp. 2019, 2023\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { ifDefined } from 'lit/directives/if-defined.js';\nimport { LitElement, html } from 'lit';\nimport { property, query } from 'lit/decorators.js';\nimport { classMap } from 'lit/directives/class-map.js';\nimport ChevronDownGlyph from '@carbon/icons/lib/chevron--down/16';\nimport { prefix } from '../../globals/settings';\nimport FocusMixin from '../../globals/mixins/focus';\nimport HostListenerMixin from '../../globals/mixins/host-listener';\nimport HostListener from '../../globals/decorators/host-listener';\nimport { forEach } from '../../globals/internal/collection-helpers';\nimport CDSHeaderMenuItem from './header-menu-item';\nimport styles from './header.scss';\nimport { carbonElement as customElement } from '../../globals/decorators/carbon-element';\n\n/**\n * Header menu.\n *\n * @element cds-header-menu\n * @csspart trigger The trigger button.\n * @csspart trigger-icon The trigger button icon.\n * @csspart menu-body The menu body.\n */\n@customElement(`${prefix}-header-menu`)\nclass CDSHeaderMenu extends HostListenerMixin(FocusMixin(LitElement)) {\n  /**\n   * The trigger button.\n   */\n  @query('[part=\"trigger\"]')\n  protected _topMenuItem!: HTMLElement;\n\n  /**\n   * keeps track if header menu has any active submenus\n   */\n  private _hasActiveChildren = false;\n\n  /**\n   * Handles `click` event handler on this element.\n   */\n  private _handleClick() {\n    this._handleUserInitiatedToggle();\n  }\n\n  /**\n   * Handler for the `keydown` event on the trigger button.\n   */\n  @HostListener('keydown')\n  // @ts-ignore: The decorator refers to this method but TS thinks this method is not referred to\n  private _handleKeydownTrigger({ key }: KeyboardEvent) {\n    if (key === 'Esc' || key === 'Escape') {\n      this._handleUserInitiatedToggle(false);\n    }\n  }\n\n  /**\n   * Handles user-initiated toggling the open state.\n   *\n   * @param [force] If specified, forces the open state to the given one.\n   */\n  private _handleUserInitiatedToggle(force = !this.expanded) {\n    this.expanded = force;\n    if (!force) {\n      this._topMenuItem.focus();\n    }\n  }\n\n  /**\n   * Handles `blur` event handler on this element.\n   */\n  @HostListener('focusout')\n  // @ts-ignore: The decorator refers to this method but TS thinks this method is not referred to\n  private _handleBlur({ relatedTarget }: FocusEvent) {\n    if (!this.contains(relatedTarget as Node)) {\n      this.expanded = false;\n    }\n  }\n\n  /**\n   * `true` if the menu should be expanded.\n   */\n  @property({ type: Boolean, reflect: true })\n  expanded = false;\n\n  /**\n   * Applies selected styles to the item if a user sets this to true and `aria-current !== 'page'`.\n   */\n  @property({ type: Boolean, attribute: 'is-active', reflect: true })\n  isActive = false;\n\n  /**\n   * The content of the trigger button.\n   */\n  @property({ attribute: 'trigger-content' })\n  triggerContent = '';\n\n  /**\n   * The `aria-label` attribute for the menu UI.\n   */\n  @property({ attribute: 'menu-label' })\n  menuLabel!: string;\n\n  connectedCallback() {\n    if (!this.hasAttribute('role')) {\n      this.setAttribute('role', 'listitem');\n    }\n    const { selectorItem } = this.constructor as typeof CDSHeaderMenu;\n    forEach(this.querySelectorAll(selectorItem), (elem) => {\n      if ((elem as CDSHeaderMenuItem).isActive === true) {\n        this._hasActiveChildren = true;\n      }\n    });\n\n    super.connectedCallback();\n  }\n\n  updated(changedProperties) {\n    if (changedProperties.has('expanded')) {\n      const { selectorItem } = this.constructor as typeof CDSHeaderMenu;\n      const { expanded } = this;\n      forEach(this.querySelectorAll(selectorItem), (elem) => {\n        (elem as HTMLElement).tabIndex = expanded ? 0 : -1;\n      });\n    }\n  }\n\n  render() {\n    const {\n      expanded,\n      isActive,\n      triggerContent,\n      menuLabel,\n      _hasActiveChildren,\n      _handleClick: handleClick,\n    } = this;\n\n    const linkClasses = classMap({\n      [`${prefix}--header__menu-item`]: true,\n      [`${prefix}--header__menu-title`]: true,\n      [`${prefix}--header__menu-item--current`]:\n        isActive || (_hasActiveChildren && !expanded),\n    });\n\n    return html`\n      <a\n        part=\"trigger\"\n        role=\"button\"\n        tabindex=\"0\"\n        class=\"${linkClasses}\"\n        href=\"javascript:void 0\"\n        aria-haspopup=\"menu\"\n        aria-expanded=\"${String(Boolean(expanded))}\"\n        @click=${handleClick}>\n        ${triggerContent}${ChevronDownGlyph({\n          part: 'trigger-icon',\n          class: `${prefix}--header__menu-arrow`,\n        })}\n      </a>\n      <ul\n        part=\"menu-body\"\n        class=\"${prefix}--header__menu\"\n        aria-label=\"${ifDefined(menuLabel)}\">\n        <slot></slot>\n      </ul>\n    `;\n  }\n\n  /**\n   * A selector that will return the menu items.\n   */\n  static get selectorItem() {\n    return `${prefix}-header-menu-item`;\n  }\n\n  static shadowRootOptions = {\n    ...LitElement.shadowRootOptions,\n    delegatesFocus: true,\n  };\n  static styles = styles; // `styles` here is a `CSSResult` generated by custom WebPack loader\n}\n\nexport default CDSHeaderMenu;\n"],"mappings":"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"}