{"version":3,"file":"demo-file-uploader.js","names":["html","LitElement","customElement","property","delay","prefix","ifDefined","FILE_UPLOADER_ITEM_STATE","BUTTON_SIZE","CDSCEDemoFileUploader","_decorate","_initialize","_LitElement","constructor","args","F","d","kind","key","value","_handleChange","event","addedFiles","detail","newFiles","map","item","id","Math","random","toString","slice","file","state","UPLOADING","multiple","_files","files","_simulateUpload","simulateUpload","concat","requestUpdate","forEach","length","_handleDelete","fileId","idToDelete","target","dataset","filter","data","size","_objectSpread","EDIT","invalid","errorSubject","errorBody","rand","COMPLETE","decorators","type","Boolean","reflect","attribute","MEDIUM","render","accept","button","buttonKind","buttonLabel","disabled","labelDescription","labelTitle","inputState","iconDescription","handleChange","handleDelete","_t","_","_t2","inputName","_t3","_t4","name","default"],"sources":["components/file-uploader/demo-file-uploader.ts"],"sourcesContent":["/**\n * @license\n *\n * Copyright IBM Corp. 2019, 2023\n *\n * This source code is licensed under the Apache-2.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\nimport { html, LitElement } from 'lit';\nimport { customElement, property } from 'lit/decorators.js';\n\nimport { delay } from 'bluebird';\nimport { prefix } from '../../globals/settings';\nimport { ifDefined } from 'lit/directives/if-defined.js';\nimport './index';\nimport { FILE_UPLOADER_ITEM_STATE } from './file-uploader-item';\nimport { BUTTON_SIZE } from '../button/button';\nimport { FileData } from './stories/types';\n\n/**\n * A class to manage file uploading states, like sending file contents to server.\n * DEMONSTRATION-PURPOSE ONLY.\n * Data/state handling in file uploading tends to involve lots of application-specific logics\n * and thus abstracting everything in a library won't be a good return on investment\n * vs. letting users copy code here and implement features that fit their needs.\n */\n@customElement(`${prefix}-ce-demo-file-uploader`)\nexport default class CDSCEDemoFileUploader extends LitElement {\n  /**\n   * The files being uploaded.\n   */\n  private _files: FileData[] = [];\n\n  /**\n   * Handles `cds-drop-container-changed` on `<cds-file-drop-container>`.\n   *\n   * @param event The event.\n   */\n  private _handleChange(event: CustomEvent) {\n    const { addedFiles } = event.detail;\n    const newFiles: FileData[] = addedFiles.map(\n      (item) =>\n        ({\n          id: Math.random().toString(36).slice(2),\n          file: item,\n          state: FILE_UPLOADER_ITEM_STATE.UPLOADING,\n        } as FileData)\n    );\n    const { multiple, _files: files, _simulateUpload: simulateUpload } = this;\n    if (multiple) {\n      this._files = files.concat(newFiles);\n      this.requestUpdate();\n      newFiles.forEach(simulateUpload, this);\n    } else if (addedFiles.length > 0) {\n      this._files = files.concat(newFiles[0]);\n      this.requestUpdate();\n      this._simulateUpload(newFiles[0]);\n    }\n  }\n\n  /**\n   * Handles `cds-file-uploader-item-deleted` on `<cds-file-uploader-item>`.\n   *\n   * @param event The event.\n   */\n  private _handleDelete(event: CustomEvent) {\n    const { fileId: idToDelete } = (event.target as HTMLElement).dataset;\n    this._files = this._files.filter(({ id }) => idToDelete !== id);\n    this.requestUpdate();\n  }\n\n  /**\n   * Simulates updating file.\n   *\n   * @param data The data of the file being uploaded.\n   */\n  private async _simulateUpload(data: FileData) {\n    const { id, file } = data;\n    if (file.size > 524288) {\n      this._files = this._files.map((item) =>\n        id !== item.id\n          ? item\n          : {\n              ...item,\n              state: FILE_UPLOADER_ITEM_STATE.EDIT,\n              invalid: true,\n              errorSubject: 'File size exceeds limit',\n              errorBody:\n                '500kb max file size. Select a new file and try again.',\n            }\n      );\n      this.requestUpdate();\n    } else {\n      // Simulates network request time\n      const rand = Math.random() * 1000;\n      await delay(rand);\n      this._files = this._files.map((item) =>\n        id !== item.id\n          ? item\n          : {\n              ...item,\n              state: FILE_UPLOADER_ITEM_STATE.COMPLETE,\n            }\n      );\n      this.requestUpdate();\n      // Shows x icon after 1 second\n      await delay(1000);\n      this._files = this._files.map((item) =>\n        id !== item.id\n          ? item\n          : {\n              ...item,\n              state: FILE_UPLOADER_ITEM_STATE.EDIT,\n            }\n      );\n      this.requestUpdate();\n    }\n  }\n\n  /**\n   * The file types the file input should accept, separated by space.\n   */\n  @property()\n  accept = '';\n\n  /**\n   * `true` if the drop container should be disabled.\n   */\n  @property({ type: Boolean, reflect: true })\n  button = false;\n\n  /**\n   * Button kind.\n   */\n  @property({ attribute: 'button-kind' })\n  buttonKind = 'primary';\n\n  /**\n   * Button label.\n   */\n  @property({ attribute: 'button-label' })\n  buttonLabel = 'Add file';\n\n  /**\n   * `true` if the drop container should be disabled.\n   */\n  @property({ type: Boolean, reflect: true })\n  disabled = false;\n\n  /**\n   * Icon description.\n   */\n  @property({ attribute: 'icon-description' })\n  iconDescription = '';\n\n  /**\n   * The input name.\n   */\n  @property({ attribute: 'input-name' })\n  inputName = '';\n\n  /**\n   * The label description text.\n   */\n  @property({ attribute: 'label-description' })\n  labelDescription = '';\n\n  /**\n   * The label title.\n   */\n  @property({ attribute: 'label-title' })\n  labelTitle = '';\n\n  /**\n   * `true` if the drop container should accept more than one files at once.\n   * Note that even with `false` set here, user _can_ select multiple files one by one.\n   */\n  @property({ type: Boolean, reflect: true })\n  multiple = false;\n\n  /**\n   * The size of the button item.\n   */\n  @property({ reflect: true })\n  size = BUTTON_SIZE.MEDIUM;\n\n  /**\n   * The state of this file uploader item.\n   */\n  @property({ reflect: true, attribute: 'input-state' })\n  inputState = '';\n\n  render() {\n    const {\n      accept,\n      button,\n      buttonKind,\n      buttonLabel,\n      disabled,\n      labelDescription,\n      labelTitle,\n      multiple,\n      size,\n      inputState,\n      iconDescription,\n      _files: files,\n      _handleChange: handleChange,\n      _handleDelete: handleDelete,\n    } = this;\n    return html`\n      <cds-file-uploader\n        label-description=\"${ifDefined(labelDescription)}\"\n        label-title=\"${ifDefined(labelTitle)}\"\n        ?disabled=\"${disabled}\">\n        ${!button\n          ? html` <cds-file-uploader-drop-container\n              accept=\"${ifDefined(accept)}\"\n              ?multiple=\"${multiple}\"\n              name=\"${ifDefined(this.inputName)}\"\n              @cds-file-uploader-drop-container-changed=\"${handleChange}\">\n              Drag and drop files here or click to upload\n            </cds-file-uploader-drop-container>`\n          : html` <cds-file-uploader-button\n              size=\"${ifDefined(size)}\"\n              button-kind=\"${buttonKind}\"\n              accept=\"${ifDefined(accept)}\"\n              name=\"${ifDefined(this.inputName)}\"\n              ?multiple=\"${multiple}\"\n              @cds-file-uploader-button-changed=\"${handleChange}\">\n              ${buttonLabel}\n            </cds-file-uploader-button>`}\n        ${files.map(\n          ({ id, invalid, file, state, errorSubject, errorBody }) => html`\n            <cds-file-uploader-item\n              data-file-id=\"${id}\"\n              ?invalid=\"${invalid}\"\n              state=\"${inputState || ifDefined(state)}\"\n              icon-description=\"${ifDefined(iconDescription)}\"\n              error-subject=\"${ifDefined(errorSubject)}\"\n              error-body=\"${ifDefined(errorBody)}\"\n              @cds-file-uploader-item-deleted=\"${handleDelete}\">\n              ${file.name}\n            </cds-file-uploader-item>\n          `\n        )}\n      </cds-file-uploader>\n    `;\n  }\n}\n"],"mappings":"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"}